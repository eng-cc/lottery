var opt={canRegister:[!1,!1,!1],isLogIn:!1},ajax=function(e,s,a){$.ajax({type:"POST",url:e,data:a,contentType:"application/json",dataType:"json",success:function(e){s(e)}})},verification=function(e){console.log(e),e.msg?(opt.canRegister[e.type]=!0,$(".userMsgLine:eq("+e.type+") small").addClass("suc")):($(".userMsgLine:eq("+e.type+") small").removeClass("suc"),opt.canRegister[e.type]=!1)},setSession=function(e){console.log(e);var s=new Date;localStorage.setItem("time",s),localStorage.setItem("head",e.msg.head),alert("注册成功")},bigBg=new Image;bigBg.src="/images/indexBg1.png",bigBg.onload=function(){var e=$(".mainPage");addclas(e,"indexBigBg")};var vm=new Vue({el:"#container"});$(".userMsgLine:eq(0) input").blur(function(){if(vm.name){var e={name:vm.name},s=JSON.stringify(e);ajax("/user/register/name",verification,s)}}),$(".userMsgLine:eq(1) input").blur(function(){if(vm.email){var e={email:vm.email},s=JSON.stringify(e);ajax("/user/register/email",verification,s)}}),$(".userMsgLine:eq(2) input").blur(function(){vm.password1&&(vm.password1===vm.password2?(opt.canRegister[2]=!0,$(".userMsgLine:eq(3) small").addClass("suc"),$(".userMsgLine:eq(2) small").addClass("suc")):(opt.canRegister[2]=!1,$(".userMsgLine:eq(3) small").removeClass("suc"),$(".userMsgLine:eq(2) small").removeClass("suc")))}),$(".userMsgLine:eq(3) input").blur(function(){vm.password2&&(vm.password1===vm.password2?(opt.canRegister[2]=!0,$(".userMsgLine:eq(3) small").addClass("suc"),$(".userMsgLine:eq(2) small").addClass("suc")):(opt.canRegister[2]=!1,$(".userMsgLine:eq(3) small").removeClass("suc"),$(".userMsgLine:eq(2) small").removeClass("suc")))}),$(".userMsgLine:eq(4) input").blur(function(){vm.occupation&&$(".userMsgLine:eq(4) small").addClass("suc")}),$(".upMsg").click(function(){if(opt.canRegister[0]&&opt.canRegister[1]&&opt.canRegister[2]){var e={name:vm.name,email:vm.email,password:vm.password1,occupation:vm.occupation},s=JSON.stringify(e);ajax("/user/register/saveMsg",setSession,s)}});var addclas=function(e,s){var a=e.className;a+=" ",a+=s},initQiniuBtn=function(e,s,a){Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:s,uptoken_url:"/upToken",domain:"http://scc1.qiniu.com",container:e,max_file_size:"5mb",flash_swf_url:"http://jssdk.demo.qiniu.io/js/plupload/Moxie.swf",max_retries:3,dragdrop:!0,drop_element:e,chunk_size:"4mb",auto_start:!0,filters:{mime_types:[{title:"Image files",extensions:"jpg,jpeg,gif,png,zip"}]},multi_selection:!1,init:{FilesAdded:function(e,s){plupload.each(s,function(e){console.log("bfuploads")})},BeforeUpload:function(e,s){console.log("bfupload")},UploadProgress:function(e,s){console.log("uploading")},FileUploaded:function(e,s,n){var i=e.getOption("domain"),o=parseJSON(n);a(i,o)},Error:function(e,s,a){console.log(s)},UploadComplete:function(){console.log("afupload")}}})};